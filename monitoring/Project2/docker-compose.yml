version: '3'

services:
     prometheus:
          image: prom/prometheus
          volumes:
               - ./prometheus:/etc/prometheus
          command:
               - '--config.file=/etc/prometheus/prometheus.yml'
          ports:
               - '9090:9090'
          restart: always

     node-exporter:
          image: prom/node-exporter
          volumes:
               - /proc:/host/proc:ro
               - /sys:/host/sys:ro
               - /:/rootfs:ro
          command:
               - '--path.procfs=/host/proc'
               - '--path.sysfs=/host/sys'
               - '--collector.filesystem.ignored-mount-points=^/(sys|proc|dev|host|etc)($$|/)'
          restart: always

     grafana:
          image: grafana/grafana
          ports:
               - '3000:3000'
          volumes:
               - grafana-data:/var/lib/grafana
          restart: always

volumes:
  grafana-data: